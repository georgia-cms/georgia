<%= content_for :messages do %>
<%= render 'georgia/shared/messages', model: @page %>
<% end %>

<h1 class="page-header">
  <%= @page.status_tag(class: 'label-big') %>
  <%= @page.title %> <small><%= @page.url %></small>
</h1>

<div id='edit_page_panel'>
  <div class="row-fluid">
    <div class="span2">
      <div class="well">
        <ul class="nav nav-list">
          <li class="nav-header">Actions</li>
          <%= Georgia::EditMetaPageActionList.new(self, @page).render %>
        </ul>
      </div>
    </div>
    <div class="span10">
      <div class="row-fluid">
        <div class="span4">
          <h3>Drafts</h3>
          <% @page.drafts.find_each do |draft| %>
          <h5>
            <%= link_to 'edit', [:edit, @page.model, draft], class: 'pull-right' %>
            <span class="muted">#<%= draft.id %></span>
            <%= draft.title %> - <small>updated <%= time_ago_in_words draft.updated_at %> ago</small>
          </h5>
          <% end -%>
          <%= link_to 'Start a new draft', [:draft, @page.becomes(Georgia::MetaPage)] %>
        </div>
        <div class="span4">
          <h3>In Review</h3>
          <% @page.reviews.find_each do |review| %>
          <h5>
            <%= link_to 'edit', [:edit, @page.model, review], class: 'pull-right' %>
            <span class="muted">#<%= review.id %></span>
            <%= review.title %> - <small>updated <%= time_ago_in_words review.updated_at %> ago</small>
          </h5>
          <% end -%>
        </div>
        <div class="span4">
          <h3>Revisions</h3>
          <% @page.revisions.find_each do |revision| %>
          <h5>
            <%= link_to 'preview', revision.preview_url, class: 'pull-right' %>
            <span class="muted">#<%= revision.id %></span>
            <%= revision.title %> - <small>stored <%= time_ago_in_words revision.updated_at %> ago</small>
          </h5>
          <% end -%>
        </div>
      </div>
    </div>
  </div>
</div>